!function(o){let s=o.cookie("token"),e=(s=s&&decodeURIComponent(s),y()),a=h("div",["cartIcon"]),i=h("div",["showcart"]),r=h("span",["counter-number"]),c=h("div",["offcanvas","offcanvas-end"]),l=h("div",["offcanvas-header"]),n=h("h5",[],$my_cart||"My Cart"),d=h("div",["offcanvas-body"]),u=null,p=!1,m=!1;function y(){let t=o.cookie("cartId");return t=t&&decodeURIComponent(t)}function h(t,e=null,a){let s=document.createElement(t);return e.length&&e.forEach(t=>s.classList.add(t)),a&&(s.innerText=a),s}function g(){return o.ajaxPromise({type:"post",url:base_url+"/guest-carts",dataType:"json",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+s)},cache:!1,async:!0}).then(t=>(o.cookie("cartId",t,{expires:1,path:"/"}),e=t))}function t(){return o.ajaxPromise({type:"get",url:`${base_url}/guest-carts/${e}/items`,dataType:"json",headers:{Authorization:"Bearer "+s},cache:!1,async:!0}).then(t=>{try{let e=0;var a=t;a&&a.map(t=>{e+=t.qty}),o(r).text(e||""),e?o(i).addClass("cartNum"):o(i).removeClass("cartNum"),i.setAttribute("style",e?"display: flex":"");{var n=a||[];let s="";n&&n.length?n.map(t=>{var e,a;s+=`<div class="list-item">
                    <div class="list-item-box d-flex justify-content-start align-items-center">
                        <div class="item-image">
                            <img src="https://s.pvcliping.com/mshop/dev/${t.sku}.png" alt="" srcset="">
                        </div>
                        <div class="item-content">
                            <h3 class="title-item">${e=t.name,a={"SafePal S1 Hardware Wallet":$safepal_s1_hardware_wallet,"SafePal Cypher Seed Board":$safepal_cypher_seed_board,"SafePal Leather Case":$safepal_leather_case,"SafePal X1 Hardware Wallet":safepal_x1_hardware_wallet,"SafePal S1 Pro Hardware Wallet":safepal_s1pro_hardware_wallet},a[e]||e}</h3>
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="input-num-canvas d-flex align-items-center" item_id="${t.item_id}">
                                    <div class="minus-canvas" id="minus-canvas-${t.sku}">-</div>
                                    <input 
                                        type="text" 
                                        id="num-input-${t.sku}" 
                                        data-min="1"
                                        data-max="1000"
                                        data-default="${t.qty}" value="${t.qty}" class="position-relative qty-input" placeholder="">
                                    <div class="plus-canvas" id="plus-canvas-${t.sku}">+</div>
                                </div>
                                <div class="price">$${t.price}</div>
                            </div>
                        </div>
                        <div class="item-delete">
                            <img data="${t.item_id}" class="item-delete-icon" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yLjUgNUg0LjE2NjY3SDE3LjUiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMS4yNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+DQo8cGF0aCBkPSJNNi42NjY2OSA1LjAwMDA4VjMuMzMzNDFDNi42NjY2OSAyLjg5MTM5IDYuODQyMjggMi40Njc0NiA3LjE1NDg0IDIuMTU0OUM3LjQ2NzQgMS44NDIzNCA3Ljg5MTMzIDEuNjY2NzUgOC4zMzMzNSAxLjY2Njc1SDExLjY2NjdDMTIuMTA4NyAxLjY2Njc1IDEyLjUzMjYgMS44NDIzNCAxMi44NDUyIDIuMTU0OUMxMy4xNTc4IDIuNDY3NDYgMTMuMzMzNCAyLjg5MTM5IDEzLjMzMzQgMy4zMzM0MVY1LjAwMDA4TTE1LjgzMzQgNS4wMDAwOFYxNi42NjY3QzE1LjgzMzQgMTcuMTA4OCAxNS42NTc4IDE3LjUzMjcgMTUuMzQ1MiAxNy44NDUzQzE1LjAzMjYgMTguMTU3OCAxNC42MDg3IDE4LjMzMzQgMTQuMTY2NyAxOC4zMzM0SDUuODMzMzVDNS4zOTEzMyAxOC4zMzM0IDQuOTY3NCAxOC4xNTc4IDQuNjU0ODQgMTcuODQ1M0M0LjM0MjI4IDE3LjUzMjcgNC4xNjY2OSAxNy4xMDg4IDQuMTY2NjkgMTYuNjY2N1Y1LjAwMDA4SDE1LjgzMzRaIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utd2lkdGg9IjEuMjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPC9zdmc+DQo=" alt="" srcset="">
                        </div>
                    </div>
                </div>`}):s=`<div class="empty">${cartEmpty||"Your cart is empty."}</div>`;o(d).find(".list-box").html(s),c.appendChild(l),c.appendChild(d),document.body.appendChild(c),o(".input-num-canvas").each((t,e)=>{var a={selectors:{addButtonSelector:".plus-canvas",subtractButtonSelector:".minus-canvas",inputSelector:"#"+o(e).find("input").attr("id")},settings:{checkValue:!0,isReadOnly:!1},changeCallback:function(t){o("#offcanvasRightCart").myLoadingStart(),o.changeCartItem(o(e).attr("item_id"),{cartItem:{qty:t}}).then(()=>{f()}).finally(()=>{o("#offcanvasRightCart").myLoadingEnd()})}};try{if(!("inputCounter"in o.fn&&"function"==typeof o.fn.inputCounter))throw"please install jquery.input-counter.js before use cart.js";o(e).inputCounter(a)}catch(t){}}),o(".item-delete-icon").on("click",function(t){var e=o(this).attr("data");o(document.body).myLoadingStart(),o.delCartItem(e).then(t=>{f()}).finally(()=>{o(document.body).myLoadingEnd()})});return}}catch(t){}}).catch(t=>{o.removeCookie("cartId",{path:"/"}),e=null,C()})}function v(){o(d).find(".divider").remove(),o(d).find(".list-total").remove();var t=`<div class="divider" style="border-color: rgb(225, 224, 236); margin: 10px 0;"></div>
        <div class="list-total d-flex justify-content-between align-items-center">
            <div>
                <div class="items"><span id="total-items-qty">0</span> ${$items||"Items"}</div> 
                <div class="total">
                    <span class="total-text">${$total||"Total"}</span>
                    <span class="price-text"></span>
                </div>
            </div>
            <div class="checkout">
                <button id="checkout" class="btn-checkout" type="button">${$checkout||"Checkout"}</button>
            </div>
        </div>`;o(d).append(t),o(d).find("#checkout").on("click",function(){window.sessionStorage.removeItem("bllingRadio"),window.location.href=url_lang?`/${url_lang}/checkout`:"/checkout"})}async function f(){await t(),await o.getCartsTotal().then(async t=>{const{items_qty:a,base_subtotal:s,items:n,subtotal:i}=t;try{await o.carGetDiscount().then(t=>{var{zhe_price:t,zhe_point:e}="string"==typeof t?JSON.parse(t):t;r(t,e)})}catch(t){r()}function r(t,e){o("#total-items-qty").length?o("#total-items-qty").text(a):u=setInterval(()=>{o("#total-items-qty").length&&(o("#total-items-qty").text(a),clearInterval(u))},200),""+e!="0"&&""+t!=""+i?o(d).find(".list-total").find(".price-text").html(`<span class="hasDiscount">$</span><span style="padding-left: 3px;">${t}</span><span style="font-size: 12px;margin-left:4px;color:#C3BAE7;text-decoration: line-through;">$${i}</span>`):o(d).find(".list-total").find(".price-text").html(i===s?`<span>$</span><span style="padding-left: 3px;">${i}</span>`:`<span>$</span><span style="padding-left: 3px;">${s}</span><span style="font-size: 12px;margin-left:4px;color:#FF453A;text-decoration: line-through;">($${i})</span>`),n&&0===n.length?(o("#checkout").attr("disabled",!0),o("#checkout").addClass("is-disabled")):(o("#checkout").attr("disabled",!1),o("#checkout").removeClass("is-disabled"))}})}function b(){i.appendChild(r),a.appendChild(i);var t=document.getElementById("gaCart");(t?(a.classList.add("gaCart"),t):document.body).appendChild(a),p=!0}async function M(){var t=window.innerWidth;t<991?(m||(t=document.getElementById("gaCartm"))&&(i.appendChild(r),a.appendChild(i),a.classList.add("gaCartm"),t.appendChild(a),m=!0),p=!1):(p||b(),m=!1)}function j(t,e){let a;return()=>{clearTimeout(a),a=setTimeout(t,e)}}o(d).append('<div class="list-box"></div>');const C=async()=>{o("#cartIcon").remove(),o("#offcanvasRightCart").remove(),e?(["ga","s1_a","s1pro_a","x1_a"].includes(isGaPage)?(M(),window.addEventListener("resize",j(M,200))):b(),await v(),await f()):g().then(async t=>{e=t,["ga","s1_a","s1pro_a","x1_a"].includes(isGaPage)?(M(),window.addEventListener("resize",j(M,200))):b(),await v(),await f()})};o.fn.myCart=function(){a.setAttribute("id","cartIcon"),a.setAttribute("data-bs-toggle","offcanvas"),a.setAttribute("data-bs-target","#offcanvasRightCart"),a.setAttribute("aria-controls","offcanvasRightCart"),c.setAttribute("tabindex",-1),c.setAttribute("id","offcanvasRightCart"),c.setAttribute("aria-labelledby","offcanvasRightLabel"),n.setAttribute("id","offcanvasRightLabel");var t=h("button",["btn-close"]);t.setAttribute("type","button"),t.setAttribute("data-bs-dismiss","offcanvas"),t.setAttribute("aria-label","Close"),l.appendChild(n),l.appendChild(t),C()},o.extend({addItemToCart(t){var e=y();return o.ajaxPromise({type:"post",url:base_url+`/guest-carts/${e}/items`,dataType:"json",contentType:"application/json;charset=utf-8",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+s)},data:JSON.stringify(t),cache:!1,async:!0}).then(async t=>{var{price:e,qty:a}=t;return gtag("event","conversion",{send_to:"AW-17097559286/lKLUCLyF980aEPaZ4Ng_",value:Number((e*a).toFixed(2)),currency:"USD"}),twqTwitter("addToCart"),await f(),t}).catch(t=>{var{status:e,responseJSON:a,statusText:s}=t;return[404,400].includes(e)&&(o.removeCookie("cartId",{path:"/"}),g()),o(document).dialog({type:"confirm",titleShow:!1,bodyNoScroll:!0,dialogClass:"dialog-cart-empty",content:[404,400].includes(e)?a&&a.message||"some errors occurred.":429===e?"Please do not click repeatedly.":s,buttons:[{class:"cart-empty",name:$Ok||"Ok",callback:()=>{window.location.reload()}}]}),t})},getCartsTotal(){var t=y();return o.ajaxPromise({type:"get",url:base_url+`/guest-carts/${t}/totals`,dataType:"json",contentType:"application/json;charset=utf-8",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+s)},cache:!1,async:!0}).then(t=>t).catch(t=>{var e=t["status"];return[404,400].includes(e)&&(o.removeCookie("cartId",{path:"/"}),g()),t})},delCartItem(t){var e=y();return o.ajaxPromise({type:"delete",url:base_url+`/guest-carts/${e}/items/`+t,dataType:"json",contentType:"application/json;charset=utf-8",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+s)},cache:!1,async:!0}).then(t=>t).catch(t=>{var{status:e,responseJSON:a,statusText:s}=t;return[404,400].includes(e)&&(o.removeCookie("cartId",{path:"/"}),g()),o(document).dialog({type:"confirm",titleShow:!1,bodyNoScroll:!0,dialogClass:"dialog-cart-empty",content:[404,400].includes(e)?a&&a.message||"some errors occurred.":429===e?"Please do not click repeatedly.":s,buttons:[{class:"cart-empty",name:$Ok||"Ok",callback:()=>{window.location.reload()}}]}),t})},changeCartItem(t,e){var a=y();return o.ajaxPromise({type:"put",url:base_url+`/guest-carts/${a}/items/`+t,dataType:"json",contentType:"application/json;charset=utf-8",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+s)},data:JSON.stringify(e),cache:!1,async:!0}).then(t=>t).catch(t=>{var{status:e,responseJSON:a,statusText:s}=t;return[404,400].includes(e)&&(o.removeCookie("cartId",{path:"/"}),g()),o(document).dialog({type:"confirm",titleShow:!1,bodyNoScroll:!0,dialogClass:"dialog-cart-empty",content:[404,400].includes(e)?a&&a.message||"some errors occurred.":429===e?"Please do not click repeatedly.":s,buttons:[{class:"cart-empty",name:$Ok||"Ok",callback:()=>{window.location.reload()}}]}),t})},promotionalDiscountsOne(){var t=y();return o.ajaxPromise({type:"get",url:base_url+"/promotionalDiscountsOne/"+t,dataType:"json",headers:{Authorization:"Bearer "+s},cache:!1,async:!0})},carGetDiscount(){return o.ajaxPromise({type:"get",url:base_url+"/getZhe/"+e,contentType:"application/json;charset=utf-8",dataType:"json",headers:{Authorization:"Bearer "+s},cache:!1,async:!0})}})}(jQuery);